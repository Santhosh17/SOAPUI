<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="b42aed05-9150-4c74-8436-2345e0504a39" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Schema Validation - AutomatedCreateContractPayment" searchProperties="true" disabled="true" maxResults="0" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="f625f0b6-9a1a-49bf-91d9-31951231e371fileName">Schema-Validation---AutomatedCreateContractPayment</con:setting><con:setting id="b42aed05-9150-4c74-8436-2345e0504a39fileName">Schema-Validation---AutomatedCreateContractPayment</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="datasource" name="getExcelData" id="924e58a9-c4b7-4d86-8868-89783f776b71"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>A:/schemaValidationCreateContractPayment.xlsx</file><worksheet>${#Project#Worksheet}</worksheet><cell>A2</cell><ignoreEmpty>false</ignoreEmpty><evaluateFormulas>false</evaluateFormulas></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>row</con:property><con:property>expectedAPIOutput</con:property><con:property>scenario</con:property><con:property>contractNumber</con:property><con:property>totalTransactionAmount</con:property><con:property>effectiveDate</con:property><con:property>transactionType</con:property><con:property>paymentType</con:property><con:property>paymentDescription</con:property><con:property>referenceNumber</con:property><con:property>invoiceNumber</con:property><con:property>territorycodeValue</con:property><con:property>messageId</con:property><con:property>timestamp</con:property><con:property>clientAppId</con:property><con:property>userId</con:property><con:property>clientLanguage</con:property><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="request" name="createContractPayment" id="83d9c48a-ea40-4fbb-aaf5-e82fc7a08624"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>Calms2CMSServiceSOAP</con:interface><con:operation>createContractPayment</con:operation><con:request name="createContractPayment" id="8e05d0b2-8f60-4824-aa70-3858c1aa39ab" defaultOutgoingWss="" defaultIncomingWss="" outgoingWss="" incomingWss=""><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://nssrvdfsdev01/calms2cms/services/Calms2CMS</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:con="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract" xmlns:com="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes">
   <soapenv:Header/>
   <soapenv:Body>
      <con:createContractPayment>
         <con:contractNumber>${getExcelData#contractNumber}</con:contractNumber>
         <con:totalTransactionAmount>${getExcelData#totalTransactionAmount}</con:totalTransactionAmount>
         <con:effectiveDate>${getExcelData#effectiveDate}</con:effectiveDate>
         <con:transactionType>${getExcelData#transactionType}</con:transactionType>
         <con:paymentType>${getExcelData#paymentType}</con:paymentType>
         <con:paymentDescription>${getExcelData#paymentDescription}</con:paymentDescription><con:referenceNumber>${getExcelData#referenceNumber}</con:referenceNumber><con:invoiceNumber>${getExcelData#invoiceNumber}</con:invoiceNumber><con:territoryCode>${getExcelData#territorycodeValue}</con:territoryCode>
         <con:audit>
            <com:messageId>${getExcelData#messageId}</com:messageId>
            <com:timestamp>${getExcelData#timestamp}</com:timestamp>
            <com:clientAppId>${getExcelData#clientAppId}</com:clientAppId>
            <com:userId>${getExcelData#userId}</com:userId>
            <com:clientLanguage>${getExcelData#clientLanguage}</com:clientLanguage>
         </con:audit>
      </con:createContractPayment>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d202ab8a-e148-4631-afea-8da0c4d33c9c"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/><con:environmentSpec><con:entry environmentId="ba5f7dc0-e8db-409c-b494-16037c932774"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4afb3ac9-5034-4c9c-8880-fc76dd54bdc6"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="3413a0c0-76cc-4f43-9482-3efe9e972e81"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a32f4f82-e311-4f8a-ba4f-accdfcbdadcf"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1d61f86f-f9a2-4364-a52c-3d321cfb1a28"><con:authProfile>No Authorization</con:authProfile></con:entry><con:entry environmentId="b796eeee-b2bf-40b2-9d2a-9d00c30d0dab"><con:authProfile>No Authorization</con:authProfile></con:entry><con:entry environmentId="263f20f9-2653-4f33-8d66-1694d38c9931"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1f7152d8-1be5-485f-bc97-18cbc1aa4ba8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="646e67d6-aa98-4b13-bf6d-4dc58edc1b75"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b0665732-cac3-4206-a83b-daa28cab3d19"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="53d9b97b-8073-471c-a279-b4038955f03c"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="3b0f4fd5-8397-4067-b032-ecfa22cfa5ff"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="02782eb4-ecaf-43ac-8f0c-0a1eeebbdd7a"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="15dff999-92e5-4da2-8a61-2a9da4ce2988"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a48a545f-36b3-49f1-bade-8da1cb59d2fe"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="112f4a66-5a4b-434d-b2bd-545253fd642c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4143f28d-a750-4734-bce6-5c2a6d3d7f9c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b76764fd-8ea2-4d21-b7df-4cb5351d4f53"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a6566457-9045-4b25-ac54-078c86d840ea"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="ae8e0480-fa17-44a7-bcc7-f4a450334b74"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="9f36af4a-1bb6-4e88-a92d-65ff3a0063c2"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1b4cb691-92fd-43d3-8eb1-2fffb04f906d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d36d30f7-59cd-4be8-8b69-bbe1d5a35292"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d2d1977c-5412-4ad0-aead-f799c1228abb"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="31740623-c48a-4d64-ba9e-c19c0684b8f8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="24ca39f1-63a3-4ac0-932a-b6649948b285"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="016d40b6-6858-4bb5-9df3-ecea7bf8cefe"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec></con:request></con:config></con:testStep><con:testStep type="groovy" name="Copy of Groovy Script(Schema Validation)" id="e420a099-295d-49fc-88eb-336324843dbd"><con:settings/><con:config><script>log.info  "   *START SCHEMA VALIDATION - createContractPayment*     "

import com.eviware.soapui.support.XmlHolder
def response = context.expand( '${CreateContractPayment#Response}' )
def holder = new XmlHolder(response)

holder.namespaces["ns1"] = "http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract"
holder.namespaces["ns4"] = "http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract"
holder.namespaces["ns3"]='http://www.whiteclarkegroup.com/services/Calms2CMS/schema/ErrorTypes'
holder.namespaces["ns2"]='http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes'


def contractNumber = context.expand( '${getExcelData#contractNumber}' )
def expectedAPIOutput = context.expand( '${getExcelData#expectedAPIOutput}' )
def scenario = context.expand( '${getExcelData#scenario}' )

log.info "Scenario :   --------------: " + scenario

try{

//log.error "Error Code     			    		: " + holder.getNodeValue('//detail[1]/ns3:businessError[1]/ns3:errorCode[1]/text()')
if (holder.getNodeValue('//faultstring[1]/text()').contains(expectedAPIoutput)){
	log.info "Schema Validation Passed"
	log.info "Contract Number------------:" + contractNumber
	log.info "Fault code ----------------:" + holder.getNodeValue('//faultcode[1]/text()')
	log.info "Fault String --------------:" + holder.getNodeValue('//faultstring[1]/text()')
	log.info "Expected Fault String -----:" + expectedAPIoutput
	log.info "Actual Fault String -------:" +holder.getNodeValue('//faultstring[1]/text()')
	assert true
}else{
	log.info "Schema Validation Failed"
	log.info "Contract Number -----------:" + contractNumber
	log.error "Fault code  --------------:" + holder.getNodeValue('//faultcode[1]/text()')
	log.error "Fault String  ------------:" + holder.getNodeValue('//faultstring[1]/text()')
	log.error "Expected Fault String ----:" + expectedAPIoutput 
	log.info "Actual Fault String -------:" +holder.getNodeValue('//faultstring[1]/text()')
	assert false 
}
}
catch (e){	
	log.error "Schema Validation did not validate properly for invalid data : "
	}
log.info  " ......*End SCHEMA VALIDATION - createContractPayment* ..................."

 
</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="ca6e86b7-bca3-4d01-81a9-19580324e697"><con:settings/><con:config><dataSourceStep>getExceldata</dataSourceStep><targetStep>getContractTransactionHistory</targetStep></con:config></con:testStep><con:properties><con:property><con:name>ContractNumber</con:name><con:value>10069293</con:value></con:property><con:property><con:name>InvoiceNumber</con:name><con:value>23456</con:value></con:property><con:property><con:name>TransactionAmount</con:name><con:value>995.01</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>3d1ef020-f50d-4350-b965-fd86c9c3a7ae</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>82ab7bc1-7fae-46e5-8643-2dde0843ff15</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>c3bca988-b22f-470e-9d48-c83325a9768e</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>ec6e0ee1-cd16-425d-8ed6-272474ea38a4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>8621450d-a3c3-4f37-bcdc-5a1fa55c4b7b</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>fa933084-54ca-49f5-adfa-ad668ccd3803</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>65315c6e-0d3c-424c-a022-1b2647cfd24f</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>49183a55-171c-4342-af30-abdd4ae0090a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>7cbd2267-96ec-4ff4-ad9a-ed36753b65e8</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:environmentSpec><con:entry environmentId="ba5f7dc0-e8db-409c-b494-16037c932774"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4afb3ac9-5034-4c9c-8880-fc76dd54bdc6"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="3413a0c0-76cc-4f43-9482-3efe9e972e81"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a32f4f82-e311-4f8a-ba4f-accdfcbdadcf"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="263f20f9-2653-4f33-8d66-1694d38c9931"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1f7152d8-1be5-485f-bc97-18cbc1aa4ba8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="646e67d6-aa98-4b13-bf6d-4dc58edc1b75"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b0665732-cac3-4206-a83b-daa28cab3d19"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="53d9b97b-8073-471c-a279-b4038955f03c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="3b0f4fd5-8397-4067-b032-ecfa22cfa5ff"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="02782eb4-ecaf-43ac-8f0c-0a1eeebbdd7a"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="15dff999-92e5-4da2-8a61-2a9da4ce2988"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a48a545f-36b3-49f1-bade-8da1cb59d2fe"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="112f4a66-5a4b-434d-b2bd-545253fd642c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4143f28d-a750-4734-bce6-5c2a6d3d7f9c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b76764fd-8ea2-4d21-b7df-4cb5351d4f53"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a6566457-9045-4b25-ac54-078c86d840ea"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="ae8e0480-fa17-44a7-bcc7-f4a450334b74"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="9f36af4a-1bb6-4e88-a92d-65ff3a0063c2"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1b4cb691-92fd-43d3-8eb1-2fffb04f906d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d36d30f7-59cd-4be8-8b69-bbe1d5a35292"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d2d1977c-5412-4ad0-aead-f799c1228abb"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="31740623-c48a-4d64-ba9e-c19c0684b8f8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="24ca39f1-63a3-4ac0-932a-b6649948b285"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>