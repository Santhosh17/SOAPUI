<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="9cc98b59-354b-4121-a609-a59ab89b2b49" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="Automated CreateContractLetter" searchProperties="true" timeout="0" maxResults="100088989" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="IncludeOverview">true</con:setting><con:setting id="IncludeResults">true</con:setting><con:setting id="FlowLayout">false</con:setting><con:setting id="ErrorDetails">true</con:setting><con:setting id="IncludeCoverage">true</con:setting><con:setting id="GeneratableJUnitReport@Style">Single Page (Print)</con:setting><con:setting id="GeneratableJUnitReport@Folder"/><con:setting id="com.smartbear.ready.history.view.ClientResultsView$OptionsForm@disable_log">false</con:setting><con:setting id="com.smartbear.ready.history.view.ClientResultsView$OptionsForm@errors_only">false</con:setting><con:setting id="com.smartbear.ready.history.view.ClientResultsView$OptionsForm@follow">false</con:setting><con:setting id="76962b4a-6b3f-43f2-ba0f-7551ef33e5eefileName">Automated-CreateContractLetter</con:setting><con:setting id="9cc98b59-354b-4121-a609-a59ab89b2b49fileName">Automated-CreateContractLetter</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="datasource" name="Data From Excel" id="8b9a8ddd-3678-48c9-b641-0c502ecb21e1"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>${projectDir}/createContractLetter.xlsx</file><worksheet>${#Project#workSheet}</worksheet><cell>${#TestSuite#TestStartCell}</cell><ignoreEmpty>false</ignoreEmpty><evaluateFormulas>false</evaluateFormulas></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>ExpectedAPIoutput</con:property><con:property>ErrorCode</con:property><con:property>letter</con:property><con:property>Scenario</con:property><con:property>externalContractNumber</con:property><con:property>customerBpId</con:property><con:property>ID</con:property><con:property>letterNumber</con:property><con:property>eventType</con:property><con:property>eventNumber</con:property><con:property>eventNumberReference</con:property><con:property>userFiledName1</con:property><con:property>userFieldValue1</con:property><con:property>userFiledName2</con:property><con:property>userFieldValue2</con:property><con:property>userFiledName3</con:property><con:property>userFieldValue3</con:property><con:property>userFiledName4</con:property><con:property>userFieldValue4</con:property><con:property>messageId</con:property><con:property>timestamp</con:property><con:property>clientAppId</con:property><con:property>userId</con:property><con:property>clientLanguage</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="datasource" name="customerIdfromdb" id="31e32ad0-e89b-4006-b736-3b13d181920f"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.teststeps.datasource.DataSourceContainer@prepared-properties">&lt;xml-fragment/></con:setting></con:settings><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Data Connection"><con:configuration><Connection>DBCALMS2CMS( Default environment )</Connection><query>Select LACMSTR.ACCT_BPMID as LACMSTR_ACCT_NUMBER
From LACMSTR where LACMSTR.ACCT_BPMID >'1000' and rownum=1
Order By LACMSTR.ACCT_BPMID Desc</query><fetchSize/><stored-procedure>false</stored-procedure></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>LACMSTR_ACCT_NUMBER</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="datasource" name="fetchMCRMCUand CustomerIdfromdb" id="31e5bd75-8401-490d-9d02-cfc2fae9f585"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.teststeps.datasource.DataSourceContainer@prepared-properties">&lt;entry key="countryCode" value="${#Project#countryCode}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Data Connection"><con:configuration><Connection>DBCALMS2CMS( Default environment )</Connection><query>Select lk.LNKNUM_EXTERNAL_REF_FIELD as lk_LNKNUM_EXTERNAL_REF_FIELD, lk.LNKNUM_INTERNAL_REF_FIELD as lk_LNKNUM_INTERNAL_REF_FIELD,
  lc.CLINK_PRIMARY as lc_CLINK_PRIMARY, lc.CLINK_SECONDARY as lc_CLINK_SECONDARY, lc.CLINK_PRIMARY_MCU as lc_CLINK_PRIMARY_MCU, a.LOAN_NUM as a_LOAN_NUM,
  a.START_DATE as a_START_DATE, a.IDD as a_IDD, a.END_DATE as a_END_DATE, a.LOAN_STATUS as a_LOAN_STATUS, a.LOAN_COUNTRY as a_LOAN_COUNTRY, lm.acct_bpmid as lm_ACCT_BPMID
From LLNKNUM lk, LCLINK lc,
    (Select ln.*, to_date(lpad(to_char(ln.LOAN_START_DATE), 6, '0'),
      'ddMMyy') As START_DATE,
      to_date(lpad(to_char(dt.TABLE_LAST_INT_DEBIT_DDMMYY), 6, '0'),
      'ddMMyy') As IDD, to_date(lpad(to_char(ln.LOAN_MATURITY), 8, '0'),
      'ddMMyyyy') As END_DATE
      From LLOAN ln, VIEW_LTABLE_LAST_DEBIT_DATE dt
    Where dt.TABLE_TERRITORY_CODE = ln.LOAN_COUNTRY) a, LACMSTR lm
Where lk.LNKNUM_INTERNAL_REF_FIELD = lc.CLINK_PRIMARY And lc.CLINK_SECONDARY =
  a.LOAN_NUM And (lc.CLINK_PRIMARY_MCU = 'Y' And a.START_DATE &lt; a.IDD And
  a.IDD &lt; a.END_DATE And a.LOAN_STATUS In (0, 8, 1, 3) And a.LOAN_COUNTRY = :countryCode
  And a.LOAN_CUSTOMER_TYPE_1 = 'P' ) and 
   a.LOAN_ACCT_1 = lm.ACCT_NUMBER and rownum=1 
   order by lk.A4GLIDENTITY desc
</query><fetchSize/><stored-procedure>false</stored-procedure></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>lk_LNKNUM_EXTERNAL_REF_FIELD</con:property><con:property>lk_LNKNUM_INTERNAL_REF_FIELD</con:property><con:property>lc_CLINK_PRIMARY</con:property><con:property>lc_CLINK_SECONDARY</con:property><con:property>lc_CLINK_PRIMARY_MCU</con:property><con:property>a_LOAN_NUM</con:property><con:property>a_START_DATE</con:property><con:property>a_IDD</con:property><con:property>a_END_DATE</con:property><con:property>a_LOAN_STATUS</con:property><con:property>a_LOAN_COUNTRY</con:property><con:property>lm_ACCT_BPMID</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="groovy" name="testDataExtract" id="8663bbbc-5a0b-4ebb-8c22-ae31e517da18"><con:settings/><con:config><script>log.info  "Create Contract Letter API -------------"
// Data from Excel
 def loan_number =""
 def customerBpId =""
def externalContractNumber = context.expand( '${Data From Excel#externalContractNumber}' )
def excelcustomerBpId = context.expand( '${Data From Excel#customerBpId}' )
def iD = context.expand( '${Data From Excel#ID}' )


def mCREF_REFERENCE = context.expand( '${fetchMCRMCUand CustomerIdfromdb#lk_LNKNUM_EXTERNAL_REF_FIELD}' )
def lk_LNKNUM_INTERNAL_REF_FIELD = context.expand( '${fetchMCRMCUand CustomerIdfromdb#lk_LNKNUM_INTERNAL_REF_FIELD}' )

def mCU_Number = context.expand( '${fetchMCRMCUand CustomerIdfromdb#lc_CLINK_SECONDARY}' )
def aCCT_NUMBER = context.expand( '${fetchMCRMCUand CustomerIdfromdb#lm_ACCT_BPMID}' )
def lACMSTR_ACCT_NUMBER = context.expand( '${customerIdfromdb#LACMSTR_ACCT_NUMBER}' )
def lm_ACCT_BPMID = context.expand( '${fetchMCRMCUand CustomerIdfromdb#lm_ACCT_BPMID}' )


if (iD == "MCR"){
	loan_number =  mCREF_REFERENCE
	log.info "MCRid "+ iD
	
}else if(iD== "MCU"){
	log.info "MCUid "+ iD
	loan_number =  mCU_Number
}else if(iD== "NA"){
	log.info "NA id "+ iD
	loan_number =  externalContractNumber
}


if(excelcustomerBpId=="DB"){
	customerBpId = lm_ACCT_BPMID
}else if (excelcustomerBpId=="DB1") {
	customerBpId = lACMSTR_ACCT_NUMBER 
}else{
	customerBpId = excelcustomerBpId
}

log.info  loan_number
log.info customerBpId
testRunner.testCase.setPropertyValue( "externalContractNumber", loan_number)
testRunner.testCase.setPropertyValue( "internalContractNumber",   lk_LNKNUM_INTERNAL_REF_FIELD )
testRunner.testCase.setPropertyValue( "customerNumber", customerBpId )
//testRunner.testCase.setPropertyValue( "expectedOutputFromExcel",  )

</script></con:config></con:testStep><con:testStep type="request" name="createContractLetter" id="a0d690f2-0382-4b13-836e-517071dd620d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>Calms2CMSServiceSOAP</con:interface><con:operation>createContractLetter</con:operation><con:request name="createContractLetter" id="0703448d-91bf-43b6-a728-bed1f59a4c07"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@remove_empty_content">true</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@strip-whitespaces">false</con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://nssrvdfsdev01/calms2cms/services/Calms2CMS</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:con="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract" xmlns:com="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes">
   <soapenv:Header/>
   <soapenv:Body>
      <con:createContractLetter>
         <con:contractNumber>
           <com:externalContractNumber>${#TestCase#externalContractNumber}</com:externalContractNumber>
            <com:internalContractNumber>${#TestCase#internalContractNumber}</com:internalContractNumber>
             </con:contractNumber>

         <con:letterNumber>${Data From Excel#letterNumber}</con:letterNumber>
         <con:eventType>${Data From Excel#eventType}</con:eventType>
         <con:eventNumber>${Data From Excel#eventNumber}</con:eventNumber>
         <con:userFields>
            <con:userField>
               <con:fieldName>${Data From Excel#userFiledName1}</con:fieldName>
               <con:fieldValue>${Data From Excel#userFieldValue1}</con:fieldValue>
            </con:userField>
            <con:userField>
               <con:fieldName>${Data From Excel#userFiledName3}</con:fieldName>
               <con:fieldValue>${Data From Excel#userFieldValue3}</con:fieldValue>
            </con:userField>
            <con:userField>
               <con:fieldName>${Data From Excel#userFiledName4}</con:fieldName>
               <con:fieldValue>${Data From Excel#userFieldValue4}</con:fieldValue>
            </con:userField>
            <con:userField>
               <con:fieldName>${Data From Excel#userFiledName2}</con:fieldName>
               <con:fieldValue>${Data From Excel#userFieldValue2}</con:fieldValue>
            </con:userField>
         </con:userFields>
         <con:applicationInfo>
            <com:tenantInfo>
               <com:tenantCode>${#Project#countryCode}</com:tenantCode>
            </com:tenantInfo>
            <com:securityAudit>
               <com:messageId>${Data From Excel#messageId}</com:messageId>
               <com:timestamp>${Data From Excel#timestamp}</com:timestamp>
               <com:clientAppId>${Data From Excel#clientAppId}</com:clientAppId>
               <com:userId>${Data From Excel#userId}</com:userId>
            <com:clientLanguage>${Data From Excel#clientLanguage}</com:clientLanguage>
<!--               <com:clientLanguage>de_DE</com:clientLanguage>
-->
            </com:securityAudit>
         </con:applicationInfo>
      </con:createContractLetter>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="aa31400f-1d04-4d99-b34a-18a391340dc5"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:addedBasicAuthenticationTypes>Basic</con:addedBasicAuthenticationTypes><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/><con:environmentSpec><con:entry environmentId="56a75185-a0e9-4062-97a6-5d8a9913bad3"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b8666c7f-7d09-4718-bd12-6e826a4fac07"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="0b328f93-9ae9-4fa4-9980-d4ee846cdada"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="e391ac43-58ac-4205-b63a-a59ac8fa096f"><con:authProfile>Basic</con:authProfile><con:username>admin</con:username><con:password>admin</con:password></con:entry><con:entry environmentId="b0665732-cac3-4206-a83b-daa28cab3d19"><con:authProfile>Basic</con:authProfile><con:username>admin</con:username><con:password>admin</con:password></con:entry><con:entry environmentId="9510a289-eeaf-4f53-b130-71b247e62fec"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="95a2ef28-4286-4bbc-8a51-c37e33c44140"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="53d9b97b-8073-471c-a279-b4038955f03c"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="a48a545f-36b3-49f1-bade-8da1cb59d2fe"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="112f4a66-5a4b-434d-b2bd-545253fd642c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4143f28d-a750-4734-bce6-5c2a6d3d7f9c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b76764fd-8ea2-4d21-b7df-4cb5351d4f53"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a6566457-9045-4b25-ac54-078c86d840ea"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="ae8e0480-fa17-44a7-bcc7-f4a450334b74"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="9f36af4a-1bb6-4e88-a92d-65ff3a0063c2"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1b4cb691-92fd-43d3-8eb1-2fffb04f906d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d36d30f7-59cd-4be8-8b69-bbe1d5a35292"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d2d1977c-5412-4ad0-aead-f799c1228abb"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="31740623-c48a-4d64-ba9e-c19c0684b8f8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="24ca39f1-63a3-4ac0-932a-b6649948b285"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="016d40b6-6858-4bb5-9df3-ecea7bf8cefe"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="2a8334e6-b846-474b-be7e-399f65ba0572"><con:settings/><con:config><delay>4000</delay></con:config></con:testStep><con:testStep type="datasource" name="fetchLetterFromLXMLMSG" id="13b04d12-471b-4426-8937-e1798fa85c3b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.teststeps.datasource.DataSourceContainer@prepared-properties">&lt;xml-fragment/></con:setting></con:settings><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Data Connection"><con:configuration><Connection>DBCALMS2CMS( Default environment )</Connection><query>select * from (select XMLMSG_DATA from LXMLmsg where xmlmsg_number in (select integlog_xmlmsg_num from Lintglog where integlog_loan_no = ${#TestCase#internalContractNumber} and integlog_system = 'ODM') order by A4GLidentity desc) where rownum=1</query><fetchSize/><stored-procedure>false</stored-procedure></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>XMLMSG_DATA</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="datasource" name="fetchLetterFromLXMLMSGKWOM" id="b290aed8-611d-40ff-a433-fdfe9e1c44bc"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.teststeps.datasource.DataSourceContainer@prepared-properties">&lt;xml-fragment/></con:setting></con:settings><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Data Connection"><con:configuration><Connection>DBCALMS2CMS( Default environment )</Connection><query>select * from (select XMLMSG_DATA from LXMLmsg where xmlmsg_number in (select integlog_xmlmsg_num from Lintglog where integlog_loan_no = ${#TestCase#internalContractNumber} and integlog_system = 'KWOM') order by A4GLidentity desc) where rownum=1</query><fetchSize/><stored-procedure>false</stored-procedure></con:configuration></con:dataSource><con:shared>false</con:shared><con:restartShared>false</con:restartShared><con:property>XMLMSG_DATA</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="groovy" name="validationScript" id="b767e08a-6779-4943-9ecc-e5b1232127d2"><con:settings/><con:config><script>log.info  "  **************************************"

import com.eviware.soapui.support.XmlHolder
def response = context.expand( '${createContractLetter#Response}' )
def holder = new XmlHolder(response)
def aCTUAL_OUTPUT = "true"

holder.namespaces["ns4"] = "http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract"
holder.namespaces["ns2"]='http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes'


// Data from excel
def scenario = context.expand( '${Data From Excel#Scenario}' )
def expectedAPIOutput = context.expand( '${Data From Excel#ExpectedAPIOutput}' )

//Data from test Case
def externalContractNumber = context.expand( '${#TestCase#externalContractNumber}' )
def customerNumber = context.expand( '${#TestCase#customerNumber}' )
def client = context.expand( '${#Project#client}' )
def xMLMSG_CONTRACT=""
def xMLMSG_DATA=""

if (client == 'DFS'){
xMLMSG_CONTRACT = context.expand( '${fetchLetterFromLXMLMSG#XMLMSG_DATA#declare namespace ns1=\'http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Letter\'; //ns1:letter[1]/ns1:data[1]/ns1:contract[1]/ns1:contractNumber[1]}' )
xMLMSG_DATA = context.expand( '${fetchLetterFromLXMLMSG#XMLMSG_DATA#declare namespace ns1=\'http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Letter\'; //ns1:letter[1]/ns1:docName[1]}' )
log.info xMLMSG_DATA
log.info xMLMSG_CONTRACT
}else{
xMLMSG_CONTRACT = context.expand( '${fetchLetterFromLXMLMSGKWOM#XMLMSG_DATA#declare namespace ns1=\'http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Letter\'; //ns1:letter[1]/ns1:data[1]/ns1:contract[1]/ns1:contractNumber[1]}' )
xMLMSG_DATA = context.expand( '${fetchLetterFromLXMLMSGKWOM#XMLMSG_DATA#declare namespace ns1=\'http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Letter\'; //ns1:letter[1]/ns1:docName[1]}' )
log.info xMLMSG_DATA
log.info xMLMSG_CONTRACT	
}
log.info "Scenario :   ----------------------------:" + scenario
log.info "External Contract Number ----------------:" +  externalContractNumber
log.info "Customer Number -------------------------:" +  customerNumber
log.info "Contract Number in LXMLMSG ......--------:" +  xMLMSG_CONTRACT





try{
if (expectedAPIOutput == 'true'){
	nodeExists = holder.getNodeValue('exists( //ns4:createContractLetterResponse/ns4:contractLetterResponse/ns4:responseStatus)')
	if (nodeExists == "true" ){
		responseStatus  = holder.getNodeValue(' //ns4:createContractLetterResponse/ns4:contractLetterResponse/ns4:responseStatus')
	
		if( responseStatus == expectedAPIOutput){
		log.info "Expected output -----:" + expectedAPIOutput
		log.info "Actual output  -------:" + responseStatus
		aCTUAL_OUTPUT = 'true'	
		}
	
	}else{
		faultString = holder.getNodeValue('//faultstring')
		log.error "Error Occured"	
		log.error "Expected output -----:" + expectedAPIOutput
		log.error "Actual output  -------:" + faultString
		aCTUAL_OUTPUT = 'false'

	}}else{
	
	value = holder.getNodeValue('//faultstring')
		if( value.contains( expectedAPIOutput)){
		log.info "Expected output ------:" + expectedAPIOutput
		log.info "Actual output  -------:" + value
		aCTUAL_OUTPUT = 'true'
		}else{
		log.error "Expected output ------:" + expectedAPIOutput
		log.error "Actual output  -------:" + value
		aCTUAL_OUTPUT = 'false'
		}
}}catch(e){
		log.error "Error log " + e ;
		aCTUAL_OUTPUT = 'false'
}

if (expectedAPIOutput == 'true'){
def letter = context.expand( '${Data From Excel#letter}' )
	if (xMLMSG_DATA == letter ){
log.info "LXMLMSG Letter Generated  :   -----------:" + xMLMSG_DATA

	}else{
		log.error "WRONG LXMLMSG Letter Generated  :   -----------:" + xMLMSG_DATA
		aCTUAL_OUTPUT = 'false'
	}
}
//testRunner.testCase.testSuite.setPropertyValue( "expectedOutPut", expectedAPIOutput )
testRunner.testCase.testSuite.setPropertyValue( "actualOutPut", aCTUAL_OUTPUT )


log.info  " ************************************************************************."
 
</script></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="93711647-ca02-449e-8e4f-62423b05b3a2" disabled="true"><con:settings/><con:config><script>def scenario = context.expand( '${Data From Excel#Scenario}' )
log.info  scenario
testCase = testRunner.testCase.testSuite.project.getTestSuiteByName("AutomatedCreateContractLetter").getTestCaseByName(scenario);
runner = testCase.run(new com.eviware.soapui.support.types.StringToObjectMap(), false);
Thread.sleep(2000)

</script></con:config></con:testStep><con:testStep type="groovy" name="SetExcelRow" id="a371d888-7420-44fc-8050-035860efa62f" disabled="true"><con:settings/><con:config><script>cell = testRunner.testCase.testSuite.getPropertyValue("startCell")
rowNumber = testRunner.testCase.testSuite.getPropertyValue("rowInrementer")
cellValue = cell+rowNumber
log.info  cellValue
testRunner.testCase.testSuite.setPropertyValue("testStartCell", cellValue)
rowNumber = rowNumber.toInteger()+1;

log.info  rowNumber
testRunner.testCase.testSuite.setPropertyValue("rowInrementer",rowNumber.toString() )</script></con:config></con:testStep><con:testStep type="datasourceloop" name="DataSource Loop" id="8e56aa65-c4a6-4d42-9980-a6138265fc1e" disabled="true"><con:settings/><con:config><dataSourceStep>Data From Excel</dataSourceStep><targetStep>fetchMCRMCUand CustomerIdfromdb</targetStep></con:config></con:testStep><con:testStep type="request" name="SOAP Request" id="abb550ac-b48c-4d82-87a5-3dc78518c144"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>Calms2CMSServiceSOAP</con:interface><con:operation>createContractLetter</con:operation><con:request name="SOAP Request" id="bc35777b-90da-42df-aa41-bbd865da7ab0"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://nssrvbmwdev01:28080/calms2cms/services/Calms2CMS</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:con="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/Contract">
   <soapenv:Header/>
   <soapenv:Body>
      <con:createContractLetter>
         <con:contractNumber>
            <com:externalContractNumber xmlns:com="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes">12</com:externalContractNumber>
            <com:internalContractNumber xmlns:com="http://www.whiteclarkegroup.com/services/Calms2CMS/schema/CommonTypes">12</com:internalContractNumber>
         </con:contractNumber>
         <con:inputRecipients xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con:inputRecipients xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con:letterNumber>12</con:letterNumber>
         <con:eventType>1</con:eventType>
         <con:eventNumber>1</con:eventNumber>
         <con:entities xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con:userFields xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         <con:applicationInfo/>
      </con:createContractLetter>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="4bd668b0-b0af-4106-a033-1b6c76e47f3a"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/><con:environmentSpec><con:entry environmentId="a48a545f-36b3-49f1-bade-8da1cb59d2fe"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="53d9b97b-8073-471c-a279-b4038955f03c"><con:authProfile>Basic admin</con:authProfile></con:entry><con:entry environmentId="112f4a66-5a4b-434d-b2bd-545253fd642c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4143f28d-a750-4734-bce6-5c2a6d3d7f9c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b76764fd-8ea2-4d21-b7df-4cb5351d4f53"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a6566457-9045-4b25-ac54-078c86d840ea"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="ae8e0480-fa17-44a7-bcc7-f4a450334b74"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="9f36af4a-1bb6-4e88-a92d-65ff3a0063c2"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1b4cb691-92fd-43d3-8eb1-2fffb04f906d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d36d30f7-59cd-4be8-8b69-bbe1d5a35292"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d2d1977c-5412-4ad0-aead-f799c1228abb"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="31740623-c48a-4d64-ba9e-c19c0684b8f8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="24ca39f1-63a3-4ac0-932a-b6649948b285"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="016d40b6-6858-4bb5-9df3-ecea7bf8cefe"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec></con:request></con:config></con:testStep><con:properties><con:property><con:name>externalContractNumber</con:name><con:value>34343434</con:value></con:property><con:property><con:name>customerNumber</con:name><con:value/></con:property><con:property><con:name>internalContractNumber</con:name><con:value>100000017</con:value></con:property></con:properties><con:reportParameters/><con:breakPoints><con:testStepId>85ede47f-f8ca-4cd9-83a6-f91378ab2d85</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a4e63a62-5902-415f-9ca1-07776e96cb0c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>9e039841-7ae1-4bde-805f-e62775db9fcf</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a204a3be-3ae1-49b6-bd37-9252225c5706</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>b82c9df4-e448-4350-bd17-7686545577ca</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>b0edca77-953a-4982-b799-deaf074cdbb3</con:testStepId><con:status>ENABLED</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>8f52d888-20b5-4cc4-b107-09cfe43e2e79</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>507f82db-2aea-4225-9ad7-35ccfb0c123c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e5bdb562-4506-40c4-94a1-60912abb3431</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a29272cc-7007-403b-b48f-db517de21586</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>1a63a2de-f148-45fa-8598-c6cefe347a5f</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>7814d44c-9aaf-42b1-a7d0-5a4da8bd4c80</con:testStepId><con:status>ENABLED</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>b29b5cc6-026a-4c53-aa5c-9d047ea12492</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2848237a-7c31-4603-82a9-62ed9bcd26c5</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>9e83653b-0454-453f-beaa-5a64b92845b2</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>3a054e0d-e891-466a-bf86-fb7b0b3b8702</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:environmentSpec><con:entry environmentId="56a75185-a0e9-4062-97a6-5d8a9913bad3"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b8666c7f-7d09-4718-bd12-6e826a4fac07"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="0b328f93-9ae9-4fa4-9980-d4ee846cdada"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="e391ac43-58ac-4205-b63a-a59ac8fa096f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="95a2ef28-4286-4bbc-8a51-c37e33c44140"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="112f4a66-5a4b-434d-b2bd-545253fd642c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="4143f28d-a750-4734-bce6-5c2a6d3d7f9c"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="b76764fd-8ea2-4d21-b7df-4cb5351d4f53"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="a6566457-9045-4b25-ac54-078c86d840ea"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="ae8e0480-fa17-44a7-bcc7-f4a450334b74"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="9f36af4a-1bb6-4e88-a92d-65ff3a0063c2"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="1b4cb691-92fd-43d3-8eb1-2fffb04f906d"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d36d30f7-59cd-4be8-8b69-bbe1d5a35292"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="d2d1977c-5412-4ad0-aead-f799c1228abb"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="31740623-c48a-4d64-ba9e-c19c0684b8f8"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="24ca39f1-63a3-4ac0-932a-b6649948b285"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>